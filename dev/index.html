<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · TrixiShockTube.jl</title><meta name="title" content="Home · TrixiShockTube.jl"/><meta property="og:title" content="Home · TrixiShockTube.jl"/><meta property="twitter:title" content="Home · TrixiShockTube.jl"/><meta name="description" content="Documentation for TrixiShockTube.jl."/><meta property="og:description" content="Documentation for TrixiShockTube.jl."/><meta property="twitter:description" content="Documentation for TrixiShockTube.jl."/><meta property="og:url" content="https://stillyslalom.github.io/TrixiShockTube.jl/"/><meta property="twitter:url" content="https://stillyslalom.github.io/TrixiShockTube.jl/"/><link rel="canonical" href="https://stillyslalom.github.io/TrixiShockTube.jl/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>TrixiShockTube.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a></li><li><a class="tocitem" href="reference/">Function reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/stillyslalom/TrixiShockTube.jl/blob/main/docs/src/index.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="TrixiShockTube"><a class="docs-heading-anchor" href="#TrixiShockTube">TrixiShockTube</a><a id="TrixiShockTube-1"></a><a class="docs-heading-anchor-permalink" href="#TrixiShockTube" title="Permalink"></a></h1><p><a href="https://github.com/stillyslalom/TrixiShockTube.jl">TrixiShockTube</a> provides utility functions to facilitate simulations of multicomponent 1D shock tube problems using <a href="https://github.com/trixi-framework/Trixi.jl">Trixi</a>.</p><p>Let&#39;s start with a simple shock tube problem consisting of nitrogen in the driver section pressurized to 3 bar, and a 50/50 mixture of nitrogen and argon at standard temperature and pressure in the driven section. Gas properties and dimensional units are provided by <a href="https://github.com/stillyslalom/PyThermo.jl">PyThermo</a> and <a href="https://github.com/PainterQubits/Unitful.jl">Unitful</a>, respectively.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using TrixiShockTube, Unitful, PyThermo</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; N₂ = Species(&quot;N2&quot;; P = 3.0u&quot;bar&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">Species(N2, 298.1 K, 3.000e+05 Pa)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; N₂Ar = Mixture([&quot;N2&quot; =&gt; 0.5, &quot;Ar&quot; =&gt; 0.5])</code><code class="nohighlight hljs ansi" style="display:block;">Mixture(50% N2, 50% Ar, 298.1 K, 1.013e+05 Pa)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; density(N₂), density(N₂Ar)</code><code class="nohighlight hljs ansi" style="display:block;">(3.3901434755196065 kg m^-3, 1.388928644742283 kg m^-3)</code></pre><p>The shock tube is initialized at rest with a discontinuity at the interface between the driver and driven sections.  <code>build_shocktube_ic</code> creates an initializer and defines the constitutive equations from a list of <code>Species</code>/<code>Mixture</code>s and  the lengths of the corresponding shock tube sections. The shock tube is then discretized using a uniform mesh with 2^8 elements.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; slabs = (N₂   =&gt; ustrip(u&quot;m&quot;, 30.0u&quot;inch&quot;),
       		N₂Ar =&gt; ustrip(u&quot;m&quot;, 125.0u&quot;inch&quot;))</code><code class="nohighlight hljs ansi" style="display:block;">(Species(N2, 298.1 K, 3.000e+05 Pa) =&gt; 0.762, Mixture(50% N2, 50% Ar, 298.1 K, 1.013e+05 Pa) =&gt; 3.175)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ic, equations = TrixiShockTube.build_shocktube_ic(slabs)</code><code class="nohighlight hljs ansi" style="display:block;">(TrixiShockTube.var&quot;#initial_condition_shock#9&quot;{Float64, Tuple{Float64, Float64}, Tuple{Float64, Float64}, TrixiShockTube.var&quot;#loc#5&quot;{Tuple{Float64, Float64}}, Int64}(0.0001, (300000.0, 101325.0), (3.3901434755196065, 1.388928644742283), TrixiShockTube.var&quot;#loc#5&quot;{Tuple{Float64, Float64}}((0.762, 3.937)), 2), CompressibleEulerMulticomponentEquations1D with 4 variables)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; semi = build_semidiscretization(slabs, ic, equations;
       	initial_refinement_level=8)</code><code class="nohighlight hljs ansi" style="display:block;">┌──────────────────────────────────────────────────────────────────────────────────────────────────┐
│ SemidiscretizationHyperbolic                                                                     │
│ ════════════════════════════                                                                     │
│ #spatial dimensions: ………………………… 1                                                                │
│ mesh: ………………………………………………………………… TreeMesh{1, Trixi.SerialTree{1, Float64}} with length 511        │
│ equations: …………………………………………………… CompressibleEulerMulticomponentEquations1D                       │
│ initial condition: ……………………………… initial_condition_shock                                          │
│ boundary conditions: ………………………… 2                                                                │
│ │ negative x: …………………………………………… boundary_condition_reflect                                       │
│ │ positive x: …………………………………………… boundary_condition_reflect                                       │
│ source terms: …………………………………………… nothing                                                          │
│ solver: …………………………………………………………… DG                                                               │
│ total #DOFs per field: …………………… 1024                                                             │
└──────────────────────────────────────────────────────────────────────────────────────────────────┘</code></pre><p>The shock tube is then evolved in time using a 5-stage, 4th order Runge-Kutta method restricted by a CFL number of 0.5. A positivity-preserving limiter is applied to the solution at each time step. The solution is saved at 1000 equally spaced time steps. Trixi.jl saves the conserved variables, so we need to convert the solution to primitive variables <code>u1, p, rho1, rho2, ...</code> with <code>xtdata</code> before plotting.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; saveat = LinRange(0, 0.02, 1000)</code><code class="nohighlight hljs ansi" style="display:block;">1000-element LinRange{Float64, Int64}:
 0.0, 2.002e-5, 4.004e-5, 6.00601e-5, …, 0.0199399, 0.01996, 0.01998, 0.02</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; limiter! = build_limiter(equations)</code><code class="nohighlight hljs ansi" style="display:block;">Trixi.PositivityPreservingLimiterZhangShu{3, Tuple{Float64, Float64, Float64}, Tuple{TrixiShockTube.var&quot;#12#15&quot;{Int64}, TrixiShockTube.var&quot;#12#15&quot;{Int64}, typeof(Trixi.pressure)}}((1.0e-7, 1.0e-7, 1.0e-7), (TrixiShockTube.var&quot;#12#15&quot;{Int64}(1), TrixiShockTube.var&quot;#12#15&quot;{Int64}(2), Trixi.pressure))</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; sol = run_shock(semi, saveat, 0.5, limiter!);</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; x, t, data = xtdata(sol, semi)</code><code class="nohighlight hljs ansi" style="display:block;">(x = [0.0, 0.002196986607142857, 0.004393973214285714, 0.006590959821428571, 0.008787946428571428, 0.010984933035714286, 0.013181919642857143, 0.01537890625, 0.015378906250000001, 0.01757589285714286  …  3.9194241071428575, 3.9216210937500002, 3.9216210937500002, 3.923818080357143, 3.9260150669642857, 3.9282120535714284, 3.9304090401785716, 3.9326060267857144, 3.934803013392857, 3.937], t = [0.0, 2.002002002002002e-5, 4.004004004004004e-5, 6.006006006006006e-5, 8.008008008008008e-5, 0.0001001001001001001, 0.00012012012012012012, 0.00014014014014014013, 0.00016016016016016016, 0.00018018018018018018  …  0.01981981981981982, 0.019839839839839838, 0.01985985985985986, 0.01987987987987988, 0.0198998998998999, 0.01991991991991992, 0.01993993993993994, 0.01995995995995996, 0.01997997997997998, 0.02], data = Dict(:p =&gt; [300000.0 300000.0 … 272690.2074227615 272010.8344962347; 300000.0 300000.0 … 272695.2726727777 272008.51315105957; … ; 101325.00000000001 101325.00000000001 … 99347.68149558663 99221.09182732315; 101325.0 101325.0 … 99345.70237841652 99216.13546151957], :rho2 =&gt; [0.0003390143475519607 0.00033901434755196063 … 0.00031419440362828033 0.0003136359609297633; 0.00033901434755196074 0.00033901434755196074 … 0.00031415566551582023 0.0003135897875338428; … ; 1.3889286447422833 1.3889286447422833 … 1.3597724238875102 1.3586174767472476; 1.388928644742283 1.388928644742283 … 1.3605741730410879 1.3593910414919972], :rho1 =&gt; [3.3901434755196065 3.3901434755196065 … 3.141944036273646 3.136359609288427; 3.3901434755196065 3.3901434755196065 … 3.1415566551546408 3.135897875334895; … ; 0.0001388928644742283 0.0001388928644742283 … 0.00013597724238875074 0.00013586174767472444; 0.0001388928644742283 0.0001388928644742283 … 0.00013605741730411046 0.0001359391041492014], :v1 =&gt; [0.0 7.467173296311456e-14 … -0.0012274802278912102 0.002628868618358378; 0.0 3.070501108483139e-15 … 0.20686566044980367 0.18879692642428558; … ; 0.0 9.298192785637292e-15 … -0.09857644761902569 -0.08183742529865548; 0.0 0.0 … 0.006195011837892328 0.0032579695624504177]))</code></pre><p>The solution is then plotted using <a href="https://github.com/MakieOrg/Makie.jl/tree/master/CairoMakie">CairoMakie</a></p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using CairoMakie</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; fig, ax, hm = heatmap(x, t, data[:p];
           axis = (xlabel = &quot;x [m]&quot;, ylabel = &quot;t [s]&quot;));</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; cb = Colorbar(fig[:, end+1], hm; label = &quot;Pressure [Pa]&quot;);</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; save(&quot;pressure.png&quot;, fig);</code></pre><p><img src="pressure.png" alt/></p><p>Let&#39;s compare to the analytic solution for the density in the reflected shock region.  The analytic solution is provided by PyThermo&#39;s unexported <code>ShockTube</code> module. The Mach  number of the incident shock is calculated using <code>calculate_Mach</code> from TrixiShockTube.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using PyThermo.ShockTube</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; Mₛ = calculate_Mach(N₂, N₂Ar)</code><code class="nohighlight hljs ansi" style="display:block;">1.2719324013758004</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; sc = shockcalc(N₂, N₂Ar, Mₛ)</code><code class="nohighlight hljs ansi" style="display:block;">  Region    P [MPa] T [K] ρ [kg/m³] cₛ [m/s]
  ––––––––– ––––––– ––––– ––––––––– ––––––––
  Driver      0.3   298.1   3.39     351.9
  Driven    0.1013  298.1   1.389    330.8
  Shocked   0.1764  360.5     2      363.6
  Reflected 0.2928  428.5   2.793    396.1

  Incident wave: 420.7 m/s (Mach 1.272)
  Reflected wave: 452.7 m/s (Mach 1.245)
  Post-shock velocity: 128.5 m/s</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; density(sc.reflected) - maximum(data[:rho2][end, :])*u&quot;kg/m^3&quot;</code><code class="nohighlight hljs ansi" style="display:block;">-0.02862511125369327 kg m^-3</code></pre></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="reference/">Function reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.2 on <span class="colophon-date" title="Tuesday 29 April 2025 19:40">Tuesday 29 April 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
